---
title: 'Valideren en simulatie van glucocorticosteroide model'
  Plague transmission model?
author: "Margriet van der Molen en Yvanka Gerdez"
date: "`r Sys.Date()`"
output:
  pdf_document:
    number_sections: yes
    toc: true
    fig_caption: true
  html_document:
    df_print: paged
header-includes:
- \usepackage{longtable}
- \usepackage{hyperref}
linkcolor: blue
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pander)
```


# Introductie
Als er gepraat wordt over de pest, wordt al snel gedacht aan de middeleeuwen. Toch is de pest in de huidige eeuw nog steeds een gevaar. Dit was te zien aan een uitbraak van de pest in Madagascar in 2017. Deze uitbraak heerste van augustus tot november\cite{Kinh}. Tijdens deze uitbraak waren er 2417 gevallen van de pest, en 209 mensen kwamen om het leven door de pest. Het risico op nog een uitbraak bestaat nog altijd en omwille van betere preventie, is het belangrijk dat er gekeken wordt naar hoe de pest zich verspreidt en in welke vormen de ziekte voorkomt onder mensen. 

De pest wordt veroorzaakt door de bacterie *Yersinia pestis*, deze bacterie mag zich graag vestigen op kleine zoogdieren maar ook vlooien\cite{WHO}. Deze bacterie komt in mensen terecht door een bijt van een geinfecteerde vlooi, onbeschermd contact met geinfecteerd materiaal, of het inademen van kleine deeltjes die afkomstig zijn van een patient met longpest. 

De World Health Organisation spreekt over 2 vormen van een pest infectie. De builenpest, deze infectie is de meest voorkomende infectie soort. *Y. pestis* komt binnen door een bijt van een vlooi en komt zo in het lymfen systeem terecht. Eenmaal in dit systeem veroorzaakt het ontstekingen in de lymfe knopen. De builenpest kan leiden tot de volgende vorm van de pest, longpest. De longpest is de meeste virulente vorm de pest, en incubatie kan al voorkomen binnen 24 uur.

Alhoewel de pest nog steeds een gevaar blijft in verschillende landen, is de behandeling ervan goed te doen met veel voorkomende soorten antibiotica. Deze behandling werkt alleen wanneer diagnose vroeg verkregen kan worden.

\newpage

#Doel

Het doel van dit onderzoek is om te kijken of de vindingen van het artikel\cite{Kinh} gerepliceerd kunnen worden. De vindingen zullen wat zeggen over hoe de pest tijdens de uitbraak verspreidt, en de potentiele invloed van het weer op de verspreiding van
de pest. Het model wat hiervoor gebruikt wordt, wordt onder de loep genomen.


Het doel van dit onderzoek is om te kijken of de vindingen van het artikel\cite{Kinh} gerepliceerd kunnen worden. De vindingen zullen wat zeggen over hoe de pest tijdens de uitbraak verspreidt, en de potentiele invloed van het weer op de verspreiding van de pest. Het model wat hiervoor gebruikt wordt, wordt onder de loep genomen.

\newpage

## Theorie


Plague transmission model (PTM).
We proposed a plague transmission model 
using a modified SEIR (Susceptible-Exposed-Infectious-Removed) model 
with two additional incorporated components reflecting the seasonal infection from infected rat fleas and imperfect sigmoidal effects of public health interventions. 

S, E, I:    Susceptible, Exposed, and Infectious:       Vatbaar, blootgesteld en besmettelijk  
p, b: longpest (pneumonic), builenpest (bubonic).  
N: populatie grootte  
Sb = pN: Het deel van de populatie dat in contact komt met de ratten vlooien met de bubonic variant (builenpest..)  
Sp = (1-p)N: Het deel van de populatie dat in contact komt met de ratten vlooien met de pneumonic variant (longpest)
firf: Infected rat fleas. Vlo dichtheid. Berekend met de volgende sinusoide functie: $firf = A+Bsin(2\pi/12t)+C*cos(2\pi/12t)$  gebasseerd op de temperatuur op madagascar.  
fitv, h: intervention. Dit zijn de stippellijnen. De plaatsen waar mensen het model kunnen beinvloeden. Berekend met de volgende functie: $fitv,h,f = 1-1/[1+0+exp(\tau h,f-t)]$


Alpha ($\alpha$): De snelheid waarmee de ziekte van vlo op mens wordt overgebracht. 
Beta ($\beta$): De snelheid waarmee de pest van mens op mens wordt overgebracht. 
Delta ($\delta$): de mensen die besmettelijk waren, die weer beter worden of sterven, waardoor de hoeveelheid besmettelijke mensen afneemt.
Epsilon ($\epsilon$): Snelheid waarmee de builenpest bij geinfecteerde mensen overgaat in de longpest variant van de ziekte. 
Gamma ($\gamma$): Hoeveelheid blootgestelde mensen (E) aan de ziekte, die er ziek van worden, waardoor ze besmettelijk (I) worden. 





Bij dit onderzoek wordt het "Plague transmission model (PTM)" gebruikt. Dit model maakt gebruik van het SEIR (Susceptible-Exposed-Infectious-Removed (Vatbaar-blootgesteld-besmettelijk-hersteld)) model. Er wordt voor de S, E en I verandering per variant van de pest, longpest (p (pneumonic)) of builenpest (b (bubonic)), een differentiaal vergelijking opgesteld. Daarnaast wordt de verandering van hoeveel besmette vlooien (firf) in acht genomen en berekend door $firf = A+Bsin(2\pi/12t)+C*cos(2\pi/12t)$ gebasseerd op de temperatuur op madagascar. En het effect dat mensen hebben op het bestrijden van de pest op verschillende plaatsen (fitv), berekend door $fitv,h,f = 1-1/[1+0+exp(\tau h,f-t)]$

Hieronder is een schematische weergave van het model gegeven die de verhouding hiertussen laat zien.
```{r, echo=FALSE, out.width='95%', fig.cap="Flowchart van het PTM(Kinh, 2018). Hier geven stippellijnen de factoren aan waar maatregelen een effect op kunnen hebben."}
knitr::include_graphics('plague_model.jpg')
```

S is het aantal mensen dat risico loopt op het krijgen van de variant van de ziekte omdat ze in de buurt zijn geweest van mensen met de ziekte. E is het aantal mensen dat ook in contact is geweest met de ziektekiemen. I is het aantal mensen dat geïnfecteerd is door de ziektekiemen en hierdoor de ziekte ook aan anderen kan doorgeven.
De totale populatie grootte wordt in N uitgedrukt. Hiervan is Sb het deel van de populatie dat risico loopt om in contact te komen met de ratten vlooien met de builenpest variant. Dit wordt pN genoemd. Sp is het deel van de populatie dat risico loopt om in contact te komen met de ratten vlooien met de longpest variant. Dit wordt (1-p)N genoemd.

Daarnaast zijn er nog een aantal parameters die snelheden van overdracht van de ziektes weergeven. Alpha ($\alpha$) i de snelheid waarmee de ziekte van vlo op mens wordt overgebracht. Beta ($\beta$) is de snelheid waarmee de pest van mens op mens wordt overgebracht. Delta ($\delta$) is de snelheid waarmee het aantal besmettelijke mensen weer afneemt, doordat ze beter worden of sterven. Epsilon ($\epsilon$) is de snelheid waarmee de builenpest bij geinfecteerde mensen overgaat in de longpest variant van de ziekte. Gamma ($\gamma$) is de hoeveelheid blootgestelde mensen (E) aan de ziekte, die er ziek van worden, waardoor ze besmettelijk (I) worden. 

Met behulp van deze parameters kunnen de volgende differentiaal vergelijkingen opgesteld worden:

.....

Hiermee worden de veranderingen in de hoeveelheid van de populatie die vatbaar zijn voor de longpest (Sp), vatbaar voor de builenpest (Sb), blootgesteld aan de longpest (Ep), blootgesteld aan de builenpest (Eb), geïnfecteerd door de longpest (Ip) en geïnfecteerd door de builenpest (Ib) bepaald.







### Het model
Met de kennis die ervan de pest is, is het volgende model opgesteld.

```{r, echo=FALSE, out.width='95%', fig.cap="Flowchart van het PTM(Kinh, 2018). Hier geven stippellijnen de factoren aan waar maatregelen een effect op kunnen hebben."}
knitr::include_graphics('plague_model.jpg')
```


### De formules
Uit dit model is af te leiden dat de concentratie voor receptor mRNA zo te berekenen valt:
$$\frac{dmRNA_R}{dt} = k_{s\_Rm} *(1-\frac{DR(N)}{IC_{50\_Rm} + DR(N)}) - k_{d\_Rm} * mRNA_R$$


De concentratie vrije receptor(R) is als volgt af te leiden:
$$\frac{dR}{dt} = k_{s\_R} * mRNA_R + R_f * k_{re} * DR(N) - k_{on} * D * R - k_{d\_R}  * R$$

De concentratie receptor complex(DR) is als volgt af te leiden:
$$\frac{dDR}{dt} = k_{on} * D *R - k_t * DR$$

De concentratie receptor complex(DR(N)) in de kern is als volgt af te leiden:
$$\frac{dDR(N)}{dt} = k_t * DR - k_{re} * DR(N)$$




# Methode

## Het software model
Gebruikt in dit model is R (versie 4.0.4) en de DeSolve library(versie 1.28)\cite{Soertaert10}. Het volgende model wordt
gebruikt:
```{r}
library(deSolve)

PTM <- function(t,state,parms){
with(as.list(c(state,parms)),{
  dSb <- -Sb*alpha*firf(t)*fitv_h(t)-beta*Sb*Ip/N*fitv_h(t)
  dSp <- -beta*Sp*Ip/N*fitv_h(t)
  dEb <- Sb*alpha*firf(t)*fitv_f(t) - gamma_b * Eb
  dEp <- beta*(Sb + Sp) * Ip / N *fitv_h(t) - gamma_p * Ep
  dIb <- gamma_b * Eb - epsilon * Ib - delta_b * Ib
  dIp <- gamma_p * Ep + epsilon * Ib - delta_p * Ip
return(list(c(dSb, dSp, dEb, dEp, dIb, dIp)))
}
)
  }

```


## Model configuratie

Omdat het doel het repliceren van het artikel\textit{Kinh} is, is er voor gekozen om dezelfde parameters te gebruiken.
```{r}
data.parameters <- read.csv("parameters.csv", header = T)
pander(data.parameters)
```

Voor de parameters die verantwoordelijk zijn voor de dichtheid van de geinfecteerde vlo en rat populatie (firf), de waarde waarin de inverventie maatregelen van vlo tot mens wordt uitgedrukt(fitv_f), en de waarde waarin de inverventie maatregelen van mens tot mens wordt uitgedrukt(fitv_h), zijn functies. Deze functies worden als parameters meegegeven en zien er als volgt uit.

```{r}
func_firf <- function(t){
  return(1.15 + 0.08 * sin(2*pi/12*t) + 0.1 * cos(2*pi/12*t))
}


func_fitv_h <- function(t){
  return(1-1/(1+0.11+exp(8.89-t)))
}

func_fitv_f <- function(t){
  return(1-1/(1+0.11+exp(17.93-t)))
}
```

Voor de initiele waardes is er vanuit gegaan dat maar een klein deel van de populatie vatbaar is voor de pest. Deze fractie mensen wordt aangegeven met de waarde p. Voor een populatie van N is de hoeveelheid vatbare mensen voor de builenpest $pN$. De hoeveelheid mensen die vatbaar zijn voor de longpest is $(1-p)N$.

```{r}
ini.waardes <- read.csv("ini_waardes.csv", header = T)
pander(ini.waardes)
```

```{r}
time <- c(seq(0, 60, by =1))

state <- c(Sb = 2557.09, Sp = 25568338, Eb = 0, Ep = 0, Ib = 1, Ip = 1)

parameters <- c(gamma_b = 0.23, gamma_p = 0.29, epsilon = 0.03,
           alpha = 0.0019, beta = 2.23, N = 25570895, delta_p = 0.34, delta_b = 0.26,
           firf = func_firf, fitv_f = func_fitv_f, fitv_h = func_fitv_h)
```

\newpage

# Resultaten

```{r}
out_1 <- ode(parms = parameters, time = time, y = state, func = PTM)
plot(out_1)
```


# Discussie en Conclusie
## Discussie


## Conclusie 


\begin{thebibliography}{9}

\bibitem{Soertaert10}
Soetaert, K., Petzoldt, T., and Woodrow Setzer, R.: \textit{Solving differential equations in R: package deSolve}, J. Stat. Softw., 33, 1-25, 2010.

\bibitem{Kinh}
Kinh Nguyen, V., Parra-Rojas, C., Hernandez-Varga, E. A. (2018, June 2).:\textit {The 2017 plague outbreak in Madagascar: Data descriptions and epidemic modelling.} ScienceDirect. https://doi.org/10.1016/j.epidem.2018.05.001 

\bibitem{WHO}
World Health Organization.:\textit {Plague. World Health Organization.} https://shorturl.at/dvHNR

\bibitem{Pander}
Daróczi G, Tsegelskyi R (2022).: \textit {pander:  An R ’Pandoc’ Writer. R package version 0.6.5},https://CRAN.R-project.org/package=pander

\end{thebibliography}
